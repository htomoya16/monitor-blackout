# AGENTS.md — monitor-blackout

このファイルは、AIエージェント（例: Codex やこのプロジェクトで使う他のエージェント）が  
`monitor-blackout` プロジェクトを理解し、正確に実装/修正/改善できるように**要点だけを記述した仕様ガイド**である。  
プロジェクトの目的と挙動、構造、受け入れ基準を明確に示す。:contentReference[oaicite:0]{index=0}

---

## 1. プロジェクト概要
**monitor-blackout** は、Windows のサブモニタ（または任意モニタ）を  
真っ黒なオーバーレイで覆い、視界ノイズを消すユーティリティである。

- 起動時に**対象モニタを黒で覆う**（オーバーレイ）
- オーバーレイ上の**ワンクリックで解除**
- 起動は**ショートカットから、対象モニタはアクティブ画面**
- ワンショット実行（ON/OFF トグル）後に起動プロセスは終了

---

## 2. 目的（WHY）
- 映画視聴や集中作業などで **サブモニタの余計な光/ウィンドウを遮断**すること  
- モニタ構成を変えず（Win+P 等を使わず）に  
  黒幕表示/解除をワンショットツールで実現する

---

## 3. 必須要件（WHAT）
### 3.1 ユーザー操作
- ユーザーは黒幕を出したい画面をクリックしてアクティブにする  
- **ショートカット実行 → 即トグル（ON→OFF/ OFF→ON）**
- ON中：**オーバーレイを1回クリック → OFF**

### 3.2 対象モニタ判定
- 起動時にアクティブなウィンドウのモニタを対象にする  
  （例: `GetForegroundWindow()` → `MonitorFromWindow()` で判定）

### 3.3 表示
- 黑背景全画面オーバーレイ
- 枠なし/windowed borderless、最前面表示
- 対象モニタの座標に正確にフィット

---

## 4. 想定構成（HOW）
### 4.1 プロセス
- `MonitorBlackout.Toggle`  
  → 起動したら状態判定し、ON/OFF転換コマンドを送出して終了
- `MonitorBlackout.Overlay`  
  → オーバーレイ維持（黒幕）プロセス  
  → クリックで終了（OFF）

### 4.2 対象モニタ取得アルゴリズム
1) 現在アクティブウィンドウのハンドルを取得  
2) そのウィンドウが属するモニタを特定  
3) モニタ領域をバウンディングボックスとして黒幕生成

### 4.3 クリックイベント
- `Overlay`は **MouseDown 全域受け取り**  
- いずれの位置でのクリックでも即終了（OFF）

---

## 5. 受け入れ基準（Acceptance Criteria）
- 起動から 1 秒以内に ON/OFF が確実に反映される  
- 対象モニタ以外を覆わない  
- ON 中はクリック 1 回で OFF が成立  
- 多重起動で黒幕が重複しない  
- オーバーレイは必ず対象モニタのboundsに収まる

---

## 6. 配布ガイドライン
- `dotnet publish --self-contained` による **self-contained** ビルド  
  → 友人PCに .NET ランタイム不要で配布可能
- 配布アーカイブは Zip 形式で構成ファイル + README 付き  
- 友人向け Zip には簡易 README を同梱

---

## 7. ドキュメント参照
- `README.md`: 人間向け説明  
- `AGENTS.md`: AIエージェント用仕様/実装指針  
- 仕様は常に最新の状態に保つこと

---

## 8. 制約・注意
- Exclusive Fullscreen（DirectX 等）環境では最前面制御が制限される可能性あり  
- DPI スケーリングで黒幕位置がズレる場合はモニタ座標換算処理を追記する

---

*注: AGENTS.mdはAIエージェントの作業効率を上げるための仕様ガイドとして用いられる。READMEより詳細かつ機械的に解釈しやすい情報を重点記載している。:contentReference[oaicite:1]{index=1}  
